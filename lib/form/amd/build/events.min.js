define ("core_form/events",["exports","core/str","core/event_dispatcher","jquery","core/yui"],function(a,b,c,d,f){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.types=a.triggerUploadCompleted=a.triggerUploadStarted=a.notifyUploadCompleted=a.notifyUploadStarted=a.notifyFieldValidationFailure=a.notifyFormSubmittedByJavascript=a.notifyFormError=a.eventTypes=a.uploadCompleted=void 0;d=g(d);f=g(f);function g(a){return a&&a.__esModule?a:{default:a}}var h;(0,b.get_string)("changesmadereallygoaway","moodle").then(function(a){h=a;return a}).catch();var i=function(a){if(a){a.returnValue=h}},j={};a.uploadCompleted=function uploadCompleted(){return Object.values(j).every(function(a){return 0==a})};var k={formError:"core_form/error",formSubmittedByJavascript:"core_form/submittedByJavascript",formFieldValidationFailed:"core_form/fieldValidationFailed",uploadStarted:"core_form/uploadStarted",uploadCompleted:"core_form/uploadCompleted"};a.eventTypes=k;a.notifyFormError=function notifyFormError(a){return(0,c.dispatchEvent)(k.formError,{},a)};a.notifyFormSubmittedByJavascript=function notifyFormSubmittedByJavascript(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:!1,d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:!1;if(b){window.skipClientValidation=!0}var e=(0,c.dispatchEvent)(k.formSubmittedByJavascript,{skipValidation:b,fallbackHandled:d},a);if(b){window.skipClientValidation=!1}return e};a.notifyFieldValidationFailure=function notifyFieldValidationFailure(a,b){return(0,c.dispatchEvent)(k.formFieldValidationFailed,{message:b},a,{cancelable:!0})};var l=function(a){j[a]=j[a]?j[a]+1:1;window.addEventListener("beforeunload",i);return(0,c.dispatchEvent)(k.uploadStarted,{},document.getElementById(a),{bubbles:!0,cancellable:!1})};a.notifyUploadStarted=l;var m=function(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:!1;if(j[a]&&0<j[a]){j[a]=b?0:j[a]-1}window.removeEventListener("beforeunload",i);return(0,c.dispatchEvent)(k.uploadCompleted,{},document.getElementById(a),{bubbles:!0,cancellable:!1})};a.notifyUploadCompleted=m;a.triggerUploadStarted=l;a.triggerUploadCompleted=m;a.types={uploadStarted:"core_form/uploadStarted",uploadCompleted:"core_form/uploadCompleted"};var n=!1;if(!n){f.default.use("event","moodle-core-event",function(){document.addEventListener(k.formError,function(a){var b=f.default.one(a.target),c=f.default.one(a.target.closest("form"));f.default.Global.fire(M.core.globalEvents.FORM_ERROR,{formid:c.generateID(),elementid:b.generateID()})});document.addEventListener(k.formSubmittedByJavascript,function(a){if(a.detail.fallbackHandled){return}if(a.skipValidation){window.skipClientValidation=!0}var b=f.default.one(a.target);b.fire(M.core.event.FORM_SUBMIT_AJAX,{currentTarget:b,fallbackHandled:!0});if(a.skipValidation){window.skipClientValidation=!1}})});document.addEventListener(k.formFieldValidationFailed,function(a){var b=d.default.Event("core_form-field-validation");(0,d.default)(a.target).trigger(b,a.detail.message)});n=!0}});
//# sourceMappingURL=events.min.js.map
